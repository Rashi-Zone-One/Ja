<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>รวมตัวอย่างโค้ด (Java to Web) - ฉบับสมบูรณ์</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap');
        
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f3f4f6;
        }

        .font-mono {
            font-family: 'Fira Code', monospace;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #c7c7c7; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8; 
        }

        .active-nav-item {
            background-color: #e0e7ff; /* Indigo 100 */
            color: #4338ca; /* Indigo 700 */
            border-right: 3px solid #4338ca;
        }

        .nav-item {
            color: #4b5563;
        }
        .nav-item:hover {
            background-color: #f3f4f6;
            color: #1f2937;
        }

        .console-bg {
            background-color: #1e1e1e;
            color: #d4d4d4;
        }

        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="h-screen flex overflow-hidden">

    <!-- Sidebar (Desktop) -->
    <aside class="w-72 bg-white shadow-xl flex flex-col z-20 hidden md:flex">
        <div class="p-5 border-b border-gray-100 bg-indigo-900 text-white">
            <h1 class="text-xl font-bold flex items-center gap-2">
                <i class="fa-brands fa-java text-2xl text-yellow-400"></i>
                <span>Java Samples</span>
            </h1>
            <p class="text-xs text-indigo-200 mt-1 pl-8">ฉบับรวมฮิต All-in-One</p>
        </div>
        
        <nav class="flex-1 overflow-y-auto py-2" id="sidebar-nav">
            <!-- Menus will be generated by JS -->
        </nav>
        
        <div class="p-3 bg-gray-50 border-t border-gray-200 text-xs text-center text-gray-400">
            Based on <a href="https://www.cp.eng.chula.ac.th/~somchai/books/samples/java-prog/index.htm" target="_blank" class="hover:underline text-indigo-500">Prof. Somchai's Book</a>
        </div>
    </aside>

    <!-- Mobile Header -->
    <div class="md:hidden fixed top-0 w-full bg-indigo-900 text-white p-4 z-30 flex justify-between items-center shadow-md">
        <h1 class="font-bold flex items-center gap-2">
            <i class="fa-brands fa-java text-yellow-400"></i> Java Samples
        </h1>
        <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="focus:outline-none">
            <i class="fa-solid fa-bars text-xl"></i>
        </button>
    </div>
    
    <!-- Mobile Menu Overlay -->
    <div id="mobile-menu" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden" onclick="this.classList.add('hidden')">
        <div class="bg-white w-64 h-full overflow-y-auto p-4" onclick="event.stopPropagation()">
            <div class="font-bold text-lg mb-4 text-indigo-900 border-b pb-2">เมนูตัวอย่าง</div>
            <nav id="mobile-nav-content" class="space-y-1">
                <!-- Mobile Menus generated by JS -->
            </nav>
        </div>
    </div>

    <!-- Main Content Area -->
    <main class="flex-1 bg-gray-100 relative flex flex-col overflow-hidden mt-14 md:mt-0">
        <!-- Header for Content -->
        <header class="bg-white shadow-sm px-6 py-4 flex justify-between items-center z-10">
            <div>
                <h2 id="page-title" class="text-2xl font-bold text-gray-800">ยินดีต้อนรับ</h2>
                <p id="page-desc" class="text-sm text-gray-500">เลือกตัวอย่างจากเมนูด้านซ้ายเพื่อเริ่มต้น</p>
            </div>
        </header>

        <!-- Dynamic Content Container -->
        <div id="content-area" class="flex-1 overflow-y-auto p-4 md:p-8">
            <!-- Content will be injected here -->
            <div class="max-w-3xl mx-auto text-center mt-10 text-gray-400">
                <i class="fa-solid fa-code text-6xl mb-4 text-gray-300"></i>
                <p class="text-lg">เลือกโปรแกรมจากเมนูซ้ายมือได้เลยครับ</p>
            </div>
        </div>
    </main>

    <!-- Templates for different apps -->
    <template id="tmpl-basic-calculator">
        <div class="max-w-xl mx-auto bg-white rounded-xl shadow-sm border border-gray-200 p-6 fade-in">
            <div class="space-y-4">
                <div id="calc-inputs" class="grid gap-4"></div>
                <button id="calc-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-lg transition shadow-md">
                    คำนวณ
                </button>
                <div id="calc-result" class="hidden mt-4 p-4 rounded-lg bg-gray-50 border border-gray-200 text-center">
                    <p class="text-gray-500 text-sm mb-1">ผลลัพธ์</p>
                    <div id="calc-result-value" class="text-2xl font-bold text-indigo-700"></div>
                </div>
            </div>
        </div>
    </template>

    <template id="tmpl-console">
        <div class="max-w-2xl mx-auto fade-in h-full flex flex-col">
            <div class="bg-gray-800 rounded-t-lg p-3 flex items-center gap-2">
                <div class="w-3 h-3 rounded-full bg-red-500"></div>
                <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                <span class="ml-2 text-xs text-gray-400 font-mono">Java Console Simulator</span>
            </div>
            <div id="console-output" class="flex-1 bg-[#1e1e1e] text-green-400 font-mono p-4 overflow-y-auto text-sm min-h-[300px] shadow-inner">
                <!-- Log output here -->
            </div>
            <div class="bg-gray-700 p-3 rounded-b-lg flex gap-2">
                <span class="text-green-500 font-mono text-lg">></span>
                <input id="console-input" type="text" class="bg-transparent border-none outline-none text-white font-mono flex-1" placeholder="พิมพ์คำสั่งหรือข้อมูลที่นี่..." autocomplete="off">
                <button id="console-run" class="text-xs bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700">RUN</button>
            </div>
        </div>
    </template>

    <template id="tmpl-game-container">
         <div class="max-w-3xl mx-auto bg-white rounded-xl shadow-sm border border-gray-200 p-6 fade-in relative min-h-[400px]" id="game-wrapper">
             <!-- Game canvas or elements go here -->
         </div>
         <div id="game-controls" class="max-w-3xl mx-auto mt-4 grid grid-cols-2 md:grid-cols-4 gap-4"></div>
    </template>

    <script>
        // --- Data Structure: Chapter & Examples ---
        const chapters = [
            {
                id: 'ch1', title: '1. บทนำ (Introduction)', icon: 'fa-solid fa-play',
                items: [
                    { id: 'hello', title: 'Hello World', ref: '1-1', type: 'console', desc: 'โปรแกรมแรกของนักเขียนโปรแกรม' },
                    { id: 'format', title: 'Hello Formatted', ref: '1-6', type: 'console', desc: 'การจัดรูปแบบข้อความ' }
                ]
            },
            {
                id: 'ch2', title: '2. การคำนวณ (Calculation)', icon: 'fa-solid fa-calculator',
                items: [
                    { id: 'circle', title: 'พื้นที่วงกลม', ref: '2-7', type: 'app', desc: 'คำนวณพื้นที่จากรัศมี' },
                    { id: 'bmi', title: 'BMI Calculator', ref: '2-8', type: 'app', desc: 'คำนวณดัชนีมวลกาย' },
                    { id: 'roots', title: 'รากสมการกำลังสอง', ref: '2-11', type: 'app', desc: 'หาค่า x จาก ax² + bx + c = 0' },
                    { id: 'temp', title: 'แปลงอุณหภูมิ', ref: '2-15', type: 'app', desc: 'Celsius <-> Fahrenheit' }
                ]
            },
            {
                id: 'ch3', title: '3. ทำซ้ำ (Repetition)', icon: 'fa-solid fa-rotate',
                items: [
                    { id: 'clock', title: 'นาฬิกาเข็มเดียว', ref: '3-3', type: 'custom', desc: 'Simulation นาฬิกา' },
                    { id: 'avg', title: 'หาค่าเฉลี่ย', ref: '3-12', type: 'app', desc: 'รับค่าหลายตัวแล้วหาค่าเฉลี่ย' },
                    { id: 'prime', title: 'ตรวจสอบจำนวนเฉพาะ', ref: '3-14', type: 'app', desc: 'Is Prime Number?' },
                    { id: 'multi', title: 'สูตรคูณ', ref: 'Custom', type: 'app', desc: 'สร้างตารางสูตรคูณ' }
                ]
            },
            {
                id: 'ch4', title: '4. เลือกปฏิบัติ (Selection)', icon: 'fa-solid fa-code-branch',
                items: [
                    { id: 'grade', title: 'ตัดเกรด', ref: '4-11', type: 'app', desc: 'คำนวณเกรดจากคะแนน' },
                    { id: 'days', title: 'วันในเดือน', ref: '4-25', type: 'app', desc: 'เดือนนี้มีกี่วัน (เช็คปีอธิกสุรทิน)' },
                    { id: 'guess', title: 'เกมทายตัวเลข', ref: '4-21', type: 'custom', desc: 'ทายเลข 1-100' },
                    { id: 'ball', title: 'ลูกบอลเด้งดึ๋ง', ref: '4-3', type: 'custom', desc: 'Animation ด้วย Canvas' }
                ]
            },
            {
                id: 'ch5', title: '5. ข้อความ (String)', icon: 'fa-solid fa-font',
                items: [
                    { id: 'rot13', title: 'รหัสลับ ROT-13', ref: '5-11', type: 'app', desc: 'เข้ารหัสแบบเลื่อนอักษร' },
                    { id: 'palin', title: 'Palindrome', ref: '5-10', type: 'app', desc: 'ตรวจสอบคำที่อ่านหน้าหลังเหมือนกัน' },
                    { id: 'wordcount', title: 'นับคำ', ref: 'Custom', type: 'app', desc: 'นับจำนวนคำในประโยค' }
                ]
            }
        ];

        // --- Core Application Logic ---
        
        // 1. Initialize UI
        function init() {
            renderSidebar();
            // Load default
            loadApp('bmi'); 
        }

        function renderSidebar() {
            const nav = document.getElementById('sidebar-nav');
            const mobileNav = document.getElementById('mobile-nav-content');
            
            let html = '';
            chapters.forEach(chap => {
                html += `
                    <div class="mb-2">
                        <div class="px-5 py-2 text-xs font-bold text-gray-400 uppercase tracking-wider mt-2">${chap.title}</div>
                        <ul>
                `;
                chap.items.forEach(item => {
                    html += `
                        <li>
                            <button onclick="loadApp('${item.id}')" id="nav-${item.id}" class="nav-item w-full text-left px-5 py-2.5 text-sm font-medium transition-colors flex items-center justify-between group">
                                <span class="flex items-center gap-2">
                                    <i class="fa-solid fa-angle-right text-xs opacity-0 group-hover:opacity-100 text-indigo-500 transition-opacity"></i>
                                    ${item.title}
                                </span>
                                <span class="text-[10px] text-gray-400 border border-gray-200 px-1 rounded bg-white">${item.ref}</span>
                            </button>
                        </li>
                    `;
                });
                html += `</ul></div>`;
            });

            nav.innerHTML = html;
            mobileNav.innerHTML = html; // Clone for mobile
        }

        // 2. Load App Router
        function loadApp(appId) {
            // UI Cleanup
            stopRunningApps(); 
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active-nav-item'));
            const activeNavs = document.querySelectorAll(`#nav-${appId}`);
            activeNavs.forEach(el => el.classList.add('active-nav-item'));

            // Find App Data
            let appData = null;
            for(const c of chapters) {
                const found = c.items.find(i => i.id === appId);
                if(found) { appData = found; break; }
            }
            
            if(!appData) return;

            // Update Header
            document.getElementById('page-title').innerHTML = `${appData.title} <span class="text-sm font-normal text-gray-400 ml-2">(${appData.ref})</span>`;
            document.getElementById('page-desc').innerText = appData.desc;

            // Clear Content
            const container = document.getElementById('content-area');
            container.innerHTML = '';

            // Inject Template based on Type
            if (appData.type === 'console') {
                const tmpl = document.getElementById('tmpl-console').content.cloneNode(true);
                container.appendChild(tmpl);
                initConsoleApp(appId);
            } else if (appData.type === 'app') {
                const tmpl = document.getElementById('tmpl-basic-calculator').content.cloneNode(true);
                container.appendChild(tmpl);
                initCalculatorApp(appId);
            } else if (appData.type === 'custom') {
                initCustomApp(appId, container);
            }

            // Hide Mobile Menu
            document.getElementById('mobile-menu').classList.add('hidden');
        }

        let currentInterval = null;
        let currentAnimation = null;

        function stopRunningApps() {
            if (currentInterval) clearInterval(currentInterval);
            if (currentAnimation) cancelAnimationFrame(currentAnimation);
        }

        // --- Logic: Calculator Apps (Form based) ---
        function initCalculatorApp(id) {
            const inputsDiv = document.getElementById('calc-inputs');
            const btn = document.getElementById('calc-btn');
            const resultVal = document.getElementById('calc-result-value');
            const resultBox = document.getElementById('calc-result');

            let calculateFn = () => {};

            // Helper for creating inputs
            const createInput = (label, pid, type='number', placeholder='') => {
                const div = document.createElement('div');
                div.innerHTML = `<label class="block text-sm font-medium text-gray-700 mb-1">${label}</label>
                                 <input type="${type}" id="${pid}" placeholder="${placeholder}" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">`;
                inputsDiv.appendChild(div);
            };

            // Setup specific forms
            if (id === 'circle') {
                createInput('รัศมีวงกลม (r)', 'inp-radius');
                calculateFn = () => {
                    const r = parseFloat(document.getElementById('inp-radius').value);
                    if (r < 0 || isNaN(r)) return "กรุณาใส่ค่าที่ถูกต้อง";
                    const area = Math.PI * r * r;
                    const circum = 2 * Math.PI * r;
                    return `พื้นที่ = ${area.toFixed(2)}<br>เส้นรอบวง = ${circum.toFixed(2)}`;
                };
            } 
            else if (id === 'bmi') {
                createInput('น้ำหนัก (กก.)', 'inp-w');
                createInput('ส่วนสูง (ซม.)', 'inp-h');
                calculateFn = () => {
                    const w = parseFloat(document.getElementById('inp-w').value);
                    const h = parseFloat(document.getElementById('inp-h').value) / 100;
                    if (!w || !h) return "ใส่ข้อมูลให้ครบถ้วน";
                    const bmi = w / (h*h);
                    let txt = "";
                    if (bmi < 18.5) txt = "(ผอม)";
                    else if (bmi < 23) txt = "(ปกติ)";
                    else if (bmi < 25) txt = "(ท้วม)";
                    else if (bmi < 30) txt = "(อ้วน)";
                    else txt = "(อ้วนมาก)";
                    return `BMI = ${bmi.toFixed(2)} <span class="text-sm text-gray-500">${txt}</span>`;
                };
            }
            else if (id === 'roots') {
                createInput('ค่า a', 'inp-a');
                createInput('ค่า b', 'inp-b');
                createInput('ค่า c', 'inp-c');
                calculateFn = () => {
                    const a = parseFloat(document.getElementById('inp-a').value);
                    const b = parseFloat(document.getElementById('inp-b').value);
                    const c = parseFloat(document.getElementById('inp-c').value);
                    if (a === 0) return "ไม่ใช่สมการกำลังสอง (a ต้องไม่เป็น 0)";
                    const delta = b*b - 4*a*c;
                    if (delta < 0) return "ไม่มีคำตอบที่เป็นจำนวนจริง";
                    const x1 = (-b + Math.sqrt(delta)) / (2*a);
                    const x2 = (-b - Math.sqrt(delta)) / (2*a);
                    return `x1 = ${x1.toFixed(2)}, x2 = ${x2.toFixed(2)}`;
                };
            }
            else if (id === 'temp') {
                createInput('อุณหภูมิ', 'inp-t');
                const sel = document.createElement('select');
                sel.id = 'inp-unit';
                sel.className = "w-full p-3 border border-gray-300 rounded-lg mt-1 mb-4";
                sel.innerHTML = `<option value="c2f">Celsius → Fahrenheit</option><option value="f2c">Fahrenheit → Celsius</option>`;
                inputsDiv.appendChild(sel);

                calculateFn = () => {
                    const t = parseFloat(document.getElementById('inp-t').value);
                    const mode = document.getElementById('inp-unit').value;
                    if(isNaN(t)) return "ใส่ตัวเลข";
                    if(mode === 'c2f') return `${t}°C = ${(t*9/5 + 32).toFixed(2)}°F`;
                    return `${t}°F = ${((t-32)*5/9).toFixed(2)}°C`;
                };
            }
            else if (id === 'avg') {
                createInput('ชุดตัวเลข (คั่นด้วยจุลภาค ,)', 'inp-nums', 'text', 'เช่น 10, 20, 30.5');
                calculateFn = () => {
                    const raw = document.getElementById('inp-nums').value;
                    const nums = raw.split(',').map(n => parseFloat(n.trim())).filter(n => !isNaN(n));
                    if(nums.length === 0) return "ไม่พบตัวเลข";
                    const sum = nums.reduce((a,b)=>a+b,0);
                    const avg = sum / nums.length;
                    const max = Math.max(...nums);
                    const min = Math.min(...nums);
                    return `เฉลี่ย = ${avg.toFixed(2)}<br><span class="text-sm">Max: ${max}, Min: ${min}, Count: ${nums.length}</span>`;
                };
            }
            else if (id === 'prime') {
                createInput('ตัวเลขจำนวนเต็มบวก', 'inp-p');
                calculateFn = () => {
                    const n = parseInt(document.getElementById('inp-p').value);
                    if(isNaN(n) || n < 2) return `${n || '?'} ไม่ใช่จำนวนเฉพาะ`;
                    let isPrime = true;
                    for(let i=2; i<=Math.sqrt(n); i++) {
                        if(n % i === 0) { isPrime = false; break; }
                    }
                    return isPrime ? `<span class="text-green-600">${n} เป็นจำนวนเฉพาะ</span>` : `<span class="text-red-500">${n} หารด้วยลงตัว</span>`;
                };
            }
            else if (id === 'grade') {
                createInput('คะแนนสอบ (0-100)', 'inp-score');
                calculateFn = () => {
                    const s = parseFloat(document.getElementById('inp-score').value);
                    if(isNaN(s) || s < 0 || s > 100) return "คะแนนไม่ถูกต้อง";
                    let g = 'F';
                    if (s >= 80) g = 'A';
                    else if (s >= 70) g = 'B';
                    else if (s >= 60) g = 'C';
                    else if (s >= 50) g = 'D';
                    return `ได้เกรด <span class="text-4xl font-bold ml-2">${g}</span>`;
                };
            }
            else if (id === 'days') {
                createInput('เดือน (1-12)', 'inp-m');
                createInput('ปี (ค.ศ.)', 'inp-y');
                calculateFn = () => {
                    const m = parseInt(document.getElementById('inp-m').value);
                    const y = parseInt(document.getElementById('inp-y').value);
                    if(m<1 || m>12 || isNaN(y)) return "ข้อมูลไม่ถูกต้อง";
                    const days = new Date(y, m, 0).getDate();
                    return `เดือน ${m} ปี ${y} มี <span class="text-indigo-600 font-bold">${days}</span> วัน`;
                };
            }
            else if (id === 'rot13') {
                createInput('ข้อความภาษาอังกฤษ', 'inp-txt', 'text');
                calculateFn = () => {
                    const s = document.getElementById('inp-txt').value;
                    return s.replace(/[a-zA-Z]/g, function(c){
                        return String.fromCharCode((c <= "Z" ? 90 : 122) >= (c = c.charCodeAt(0) + 13) ? c : c - 26);
                    });
                };
            }
            else if (id === 'palin') {
                createInput('ข้อความ', 'inp-pal', 'text');
                calculateFn = () => {
                    const s = document.getElementById('inp-pal').value.toLowerCase().replace(/[^a-z0-9ก-๙]/g, '');
                    const rev = s.split('').reverse().join('');
                    return (s === rev && s.length > 0) ? "เป็น Palindrome ✅" : "ไม่เป็น Palindrome ❌";
                };
            }
            else if (id === 'wordcount') {
                createInput('ข้อความ / ประโยค', 'inp-wc', 'text');
                // Change input to textarea
                const inp = document.getElementById('inp-wc');
                const ta = document.createElement('textarea');
                ta.id = 'inp-wc';
                ta.className = inp.className;
                ta.rows = 4;
                inp.replaceWith(ta);
                
                calculateFn = () => {
                    const val = document.getElementById('inp-wc').value.trim();
                    if(!val) return "0 คำ";
                    const count = val.split(/\s+/).length;
                    return `${count} คำ`;
                };
            }
            else if (id === 'multi') {
                createInput('แม่สูตรคูณ (2-99)', 'inp-mul');
                calculateFn = () => {
                    const m = parseInt(document.getElementById('inp-mul').value);
                    if(!m) return "";
                    let html = `<div class="grid grid-cols-2 gap-2 text-left bg-white p-2">`;
                    for(let i=1; i<=12; i++) {
                        html += `<div>${m} x ${i}</div><div class="font-bold">= ${m*i}</div>`;
                    }
                    html += `</div>`;
                    return html;
                };
            }

            // Bind Event
            btn.onclick = () => {
                const res = calculateFn();
                resultBox.classList.remove('hidden');
                resultVal.innerHTML = res;
            };
        }

        // --- Logic: Console App ---
        function initConsoleApp(id) {
            const out = document.getElementById('console-output');
            const inp = document.getElementById('console-input');
            const runBtn = document.getElementById('console-run');

            const log = (msg, color='text-green-400') => {
                const line = document.createElement('div');
                line.className = `mb-1 ${color}`;
                line.innerText = msg;
                out.appendChild(line);
                out.scrollTop = out.scrollHeight;
            };

            const runLogic = () => {
                out.innerHTML = ''; // Clear
                if (id === 'hello') {
                    log("Compiling Hello.java...", "text-yellow-500");
                    setTimeout(() => log("Hello World"), 600);
                } else if (id === 'format') {
                    log("Compiling HelloFormat.java...", "text-yellow-500");
                    setTimeout(() => {
                        log("Hello World");
                        log("    Hello     World");
                        log("123 + 456 = 579");
                    }, 600);
                }
            };

            runBtn.onclick = runLogic;
            // Auto run for simple ones
            setTimeout(runLogic, 500);
        }

        // --- Logic: Custom Complex Apps ---
        function initCustomApp(id, container) {
            if (id === 'guess') {
                container.innerHTML = `
                <div class="max-w-md mx-auto bg-white p-8 rounded-xl shadow border text-center">
                    <h3 class="text-xl font-bold mb-4">เกมทายตัวเลข 1-100</h3>
                    <p class="mb-4 text-gray-500" id="guess-msg">ผมคิดเลขไว้แล้ว ลองทายดูสิ</p>
                    <input type="number" id="g-input" class="w-24 text-center text-2xl border rounded p-2 mb-4">
                    <br>
                    <button onclick="guessLogic()" class="bg-indigo-600 text-white px-6 py-2 rounded shadow hover:bg-indigo-700">ทาย!</button>
                    <button onclick="guessReset()" class="ml-2 text-indigo-600 underline">เริ่มใหม่</button>
                    <p class="mt-4 text-sm text-gray-400">ประวัติ: <span id="g-hist"></span></p>
                </div>`;
                window.guessTarget = Math.floor(Math.random()*100)+1;
                window.guessHist = [];
                window.guessReset = () => {
                    window.guessTarget = Math.floor(Math.random()*100)+1;
                    window.guessHist = [];
                    document.getElementById('guess-msg').innerText = "เริ่มเกมใหม่แล้ว!";
                    document.getElementById('guess-msg').className = "mb-4 text-gray-500";
                    document.getElementById('g-hist').innerText = "";
                    document.getElementById('g-input').value = "";
                };
                window.guessLogic = () => {
                    const v = parseInt(document.getElementById('g-input').value);
                    if(!v) return;
                    window.guessHist.push(v);
                    document.getElementById('g-hist').innerText = window.guessHist.join(', ');
                    const msg = document.getElementById('guess-msg');
                    if(v < window.guessTarget) { msg.innerText = "น้อยไปครับ!"; msg.className="mb-4 text-red-500 font-bold"; }
                    else if(v > window.guessTarget) { msg.innerText = "มากไปครับ!"; msg.className="mb-4 text-red-500 font-bold"; }
                    else { msg.innerHTML = `ถูกต้อง! คือเลข ${window.guessTarget} <br>(ทาย ${window.guessHist.length} ครั้ง)`; msg.className="mb-4 text-green-600 font-bold text-xl"; }
                    document.getElementById('g-input').value = "";
                    document.getElementById('g-input').focus();
                };
            }
            else if (id === 'clock') {
                container.innerHTML = `
                <div class="flex flex-col items-center justify-center h-[400px]">
                    <div class="relative w-64 h-64 border-8 border-gray-800 rounded-full flex items-center justify-center bg-white shadow-xl">
                        <div class="absolute w-2 h-2 bg-red-500 rounded-full z-10"></div>
                        <div id="hand-sec" class="absolute w-1 h-28 bg-red-400 origin-bottom bottom-1/2 rounded-full transition-transform duration-100 ease-linear"></div>
                        <div id="hand-min" class="absolute w-1.5 h-24 bg-gray-600 origin-bottom bottom-1/2 rounded-full"></div>
                        <div id="hand-hour" class="absolute w-2 h-16 bg-gray-800 origin-bottom bottom-1/2 rounded-full"></div>
                        
                        <!-- Markers -->
                        <div class="absolute top-2 font-bold text-gray-400">12</div>
                        <div class="absolute bottom-2 font-bold text-gray-400">6</div>
                        <div class="absolute left-3 font-bold text-gray-400">9</div>
                        <div class="absolute right-3 font-bold text-gray-400">3</div>
                    </div>
                    <p class="mt-8 font-mono text-2xl text-gray-700" id="digital-clock">00:00:00</p>
                </div>`;
                
                const updateClock = () => {
                    const now = new Date();
                    const s = now.getSeconds();
                    const m = now.getMinutes();
                    const h = now.getHours();
                    
                    const sDeg = (s / 60) * 360;
                    const mDeg = ((m + s/60) / 60) * 360;
                    const hDeg = ((h + m/60) / 12) * 360;

                    const secEl = document.getElementById('hand-sec');
                    if(secEl) {
                         secEl.style.transform = `rotate(${sDeg}deg)`;
                         document.getElementById('hand-min').style.transform = `rotate(${mDeg}deg)`;
                         document.getElementById('hand-hour').style.transform = `rotate(${hDeg}deg)`;
                         document.getElementById('digital-clock').innerText = now.toLocaleTimeString('th-TH');
                    }
                };
                currentInterval = setInterval(updateClock, 1000);
                updateClock();
            }
            else if (id === 'ball') {
                 container.innerHTML = `
                 <div class="relative w-full max-w-2xl mx-auto h-[400px] bg-white border-2 border-gray-300 rounded overflow-hidden shadow-inner cursor-pointer" onclick="resetBall(event)">
                    <canvas id="b-canvas" class="w-full h-full"></canvas>
                    <div class="absolute bottom-2 left-2 text-xs text-gray-300 select-none">Click to reset ball</div>
                 </div>`;
                 
                 setTimeout(() => {
                    const cvs = document.getElementById('b-canvas');
                    if(!cvs) return;
                    cvs.width = cvs.offsetWidth;
                    cvs.height = cvs.offsetHeight;
                    const ctx = cvs.getContext('2d');
                    
                    let b = { x: 50, y: 50, vx: 4, vy: 3, r: 15, color: '#4f46e5' };
                    
                    window.resetBall = (e) => {
                        const rect = cvs.getBoundingClientRect();
                        b.x = e.clientX - rect.left;
                        b.y = e.clientY - rect.top;
                        b.vx = (Math.random() - 0.5) * 10;
                        b.vy = (Math.random() - 0.5) * 10;
                        b.color = `hsl(${Math.random()*360}, 70%, 50%)`;
                    };

                    const loop = () => {
                        ctx.clearRect(0,0,cvs.width,cvs.height);
                        
                        // Physics
                        b.x += b.vx;
                        b.y += b.vy;
                        
                        // Bounce with gravity effect slight
                        // b.vy += 0.1; // gravity

                        if(b.x + b.r > cvs.width) { b.x = cvs.width - b.r; b.vx *= -0.9; }
                        else if(b.x - b.r < 0) { b.x = b.r; b.vx *= -0.9; }
                        
                        if(b.y + b.r > cvs.height) { b.y = cvs.height - b.r; b.vy *= -0.9; }
                        else if(b.y - b.r < 0) { b.y = b.r; b.vy *= -0.9; }

                        // Draw
                        ctx.beginPath();
                        ctx.arc(b.x, b.y, b.r, 0, Math.PI*2);
                        ctx.fillStyle = b.color;
                        ctx.fill();
                        
                        // Trail
                        ctx.fillStyle = 'rgba(255,255,255,0.1)';
                        ctx.fillRect(0,0,cvs.width,cvs.height);

                        currentAnimation = requestAnimationFrame(loop);
                    };
                    loop();
                 }, 100);
            }
        }

        // Start
        window.onload = init;

    </script>
</body>
</html>